{"id":1818289038,"question_id":4037,"lang":"python3","lang_name":"Python3","time":"2 weeks, 2 days","timestamp":1762056492,"status":10,"status_display":"Accepted","runtime":"423 ms","url":"/submissions/detail/1818289038/","is_pending":"Not Pending","title":"Lexicographically Smallest Palindromic Permutation Greater Than Target","memory":"18.5 MB","code":"class Solution:\n    def lexPalindromicPermutation(self, s: str, target: str) -> str:\n        cc = Counter(s)\n        cnt = OrderedDict(sorted(cc.items()))\n\n        odds = []\n        for k, v in cnt.items():\n            if v % 2 == 1:\n                odds.append(k)\n        if len(odds) > 1:\n            return \"\"\n\n        for k in [i for i in cnt]:\n            cnt[k] //= 2\n\n        # @cache\n        def full(val):\n            if len(s) % 2 == 0:\n                return val + val[::-1]\n            else:\n                return val + odds[0] + val[::-1]\n\n        ans = \"\"\n        \n        @cache\n        def dfs(pref, bigger):\n            nonlocal ans\n            if 2*len(pref) + len(odds) == len(target) and (f := full(pref)) > target:\n                ans = min(ans, f) if ans != \"\" else f\n                return\n                \n            if pref < target[:len(pref)]:\n                return\n\n            if bigger:\n                rr = \"\"\n                for k, v in cnt.items():\n                    for _ in range(v):\n                        rr += k\n                print(pref + rr)\n                f = full(pref + rr)\n                if f > target:\n                    ans = min(ans, f) if ans != \"\" else f\n                    return\n            \n\n            for k in cnt:\n                if cnt[k] <= 0 or (not bigger and k < target[len(pref)]):\n                    continue\n                \n                cnt[k] -= 1\n                if (k > target[len(pref)]):\n                    dfs(pref + k, True)\n                else:\n                    dfs(pref + k, bigger)\n                cnt[k] += 1\n\n        dfs(\"\", False)\n        dfs.cache_clear()\n        return ans if ans > target else \"\"\n","compare_result":"111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111","title_slug":"lexicographically-smallest-palindromic-permutation-greater-than-target","has_notes":false,"flag_type":1,"frontend_id":1341}