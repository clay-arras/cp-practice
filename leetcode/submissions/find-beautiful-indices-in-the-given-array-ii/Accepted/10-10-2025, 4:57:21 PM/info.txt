{"id":1797778520,"question_id":3303,"lang":"cpp","lang_name":"C++","time":"1 month, 1 week","timestamp":1760140641,"status":10,"status_display":"Accepted","runtime":"116 ms","url":"/submissions/detail/1797778520/","is_pending":"Not Pending","title":"Find Beautiful Indices in the Given Array II","memory":"179.8 MB","code":"class Solution {\npublic:\n    vector<int> rabin_karp(string const& s, string const& t) {\n        const int p = 31; \n        const int m = 1e9 + 9;\n        int S = s.size(), T = t.size();\n    \n        vector<long long> p_pow(max(S, T)); \n        p_pow[0] = 1; \n        for (int i = 1; i < (int)p_pow.size(); i++) \n            p_pow[i] = (p_pow[i-1] * p) % m;\n    \n        vector<long long> h(T + 1, 0); \n        for (int i = 0; i < T; i++)\n            h[i+1] = (h[i] + (t[i] - 'a' + 1) * p_pow[i]) % m; \n        long long h_s = 0; \n        for (int i = 0; i < S; i++) \n            h_s = (h_s + (s[i] - 'a' + 1) * p_pow[i]) % m; \n    \n        vector<int> occurrences;\n        for (int i = 0; i + S - 1 < T; i++) {\n            long long cur_h = (h[i+S] + m - h[i]) % m;\n            if (cur_h == h_s * p_pow[i] % m)\n                occurrences.push_back(i);\n        }\n        return occurrences;\n    }\n\n    vector<int> beautifulIndices(string s, string a, string b, int k) {\n        int N = (int)s.size();\n        vector<int> vj = rabin_karp(b, s);\n\n        vector<int> intv(N, 0);\n        int last = 0;\n        for (int i : vj) {\n            last = max(last, i-k);\n            for (int j=last; j<=i+k && j<N; j++)\n                intv[j] = 1;\n            last = max(last, i+k);\n        }\n\n        vector<int> vi = rabin_karp(a, s);\n        vector<int> ans;\n        for (int i : vi)\n            if (intv[i])\n                ans.push_back(i);\n\n        return ans;\n    }\n};","compare_result":"1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111","title_slug":"find-beautiful-indices-in-the-given-array-ii","has_notes":false,"flag_type":1,"frontend_id":1258}