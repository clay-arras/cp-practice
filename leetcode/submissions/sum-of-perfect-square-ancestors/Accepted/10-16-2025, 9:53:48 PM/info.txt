{"id":1803938345,"question_id":3957,"lang":"cpp","lang_name":"C++","time":"1Â month","timestamp":1760676828,"status":10,"status_display":"Accepted","runtime":"2210 ms","url":"/submissions/detail/1803938345/","is_pending":"Not Pending","title":"Sum of Perfect Square Ancestors","memory":"528 MB","code":"class Solution {\npublic:\n    struct UnorderedSetHasher {\n        std::size_t operator()(const std::unordered_set<int>& s) const {\n            std::size_t h = 0;\n            for (int val : s) {\n                h ^= std::hash<int>{}(val) + 0x9e3779b9 + (h << 6) + (h >> 2);\n            }\n            return h;\n        }\n    };\n\n    const static int MX = 1e5+7;\n    vector<int> adj_list[MX];\n    vector<bool> visited;\n    unordered_map<unordered_set<int>, int, UnorderedSetHasher> hash;\n    vector<unordered_set<int>> factors;\n\n    long long ans = 0;\n    void dfs(int x) {\n        visited[x] = true;\n        ans += hash[factors[x]];\n        hash[factors[x]]++;\n\n        for (int i : adj_list[x]) {\n            if (!visited[i])\n                dfs(i);\n        }\n        hash[factors[x]]--;\n    }\n\n    long long sumOfAncestors(int n, vector<vector<int>>& edges, vector<int>& nums) {\n        for (auto e : edges) {\n            adj_list[e[0]].push_back(e[1]);\n            adj_list[e[1]].push_back(e[0]);\n        }\n\n        int mx = *max_element(nums.begin(), nums.end());\n        for (int i : nums) {\n            unordered_set<int> odds;\n            for (int f=2; f<=sqrt(mx) + 1; f++) {\n                int cnt = 0;\n                for (; i%f == 0; cnt++) \n                    i /= f;\n                if (cnt % 2) odds.insert(f);\n            }\n            odds.insert(i);\n            factors.push_back(odds);\n        }\n\n        visited = vector<bool>(n, false);\n        dfs(0);\n        return ans;\n    }\n};","compare_result":"11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111","title_slug":"sum-of-perfect-square-ancestors","has_notes":false,"flag_type":1,"frontend_id":1272}