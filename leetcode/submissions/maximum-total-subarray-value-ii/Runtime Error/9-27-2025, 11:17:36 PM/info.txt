{"id":1785016458,"question_id":4007,"lang":"cpp","lang_name":"C++","time":"1 month, 3 weeks","timestamp":1759040256,"status":15,"status_display":"Runtime Error","runtime":"N/A","url":"/submissions/detail/1785016458/","is_pending":"Not Pending","title":"Maximum Total Subarray Value II","memory":"N/A","code":"class Solution {\npublic:\n    template<class T>\n    struct RMinQ {\n        vector<T> v; vector<vector<int>> jmp;\n        int level(int x) { return 31-__builtin_clz(x); }\n        int cmb(int a, int b) {\n            if (v[a] == v[b])\n                return min(a, b);\n            return v[a] < v[b] ? a : b;\n        }\n        void init(const vector<T>& _v) {\n            int sz = (int)_v.size();\n            jmp = { vector<int>(sz) };\n            v = _v;\n            iota(jmp[0].begin(), jmp[0].end(), 0);\n            for (int j=1; (1<<j)<=sz; j++) {\n                jmp.push_back(vector<int>(sz-(1<<j)+1));\n                for (int i=0; i<(int)jmp[j].size(); i++)\n                    jmp[j][i] = cmb(jmp[j-1][i], jmp[j-1][i+(1<<(j-1))]);\n            }\n        }\n        int index(int l, int r) {\n            int d = level(r-l+1);\n            assert(l <= r);\n            return cmb(jmp[d][l], jmp[d][r-(1<<d)+1]);\n        }\n        T query(int l, int r) { return v[index(l,r)]; }\n    };\n    \n    template<class T>\n    struct RMaxQ {\n        vector<T> v; vector<vector<int>> jmp;\n        int level(int x) { return 31-__builtin_clz(x); }\n        int cmb(int a, int b) {\n            if (v[a] == v[b])\n                return max(a, b);\n            return v[a] > v[b] ? a : b;\n        }\n        void init(const vector<T>& _v) {\n            int sz = (int)_v.size();\n            jmp = { vector<int>(sz) };\n            v = _v;\n            iota(jmp[0].begin(), jmp[0].end(), 0);\n            for (int j=1; (1<<j)<=sz; j++) {\n                jmp.push_back(vector<int>(sz-(1<<j)+1));\n                for (int i=0; i<(int)jmp[j].size(); i++)\n                    jmp[j][i] = cmb(jmp[j-1][i], jmp[j-1][i+(1<<(j-1))]);\n            }\n        }\n        int index(int l, int r) {\n            int d = level(r-l+1);\n            assert(l <= r);\n            return cmb(jmp[d][l], jmp[d][r-(1<<d)+1]);\n        }\n        T query(int l, int r) { return v[index(l,r)]; }\n    };\n\n    long long maxTotalValue(vector<int>& nums, int k) {\n        int N = (int)nums.size();\n\n        vector<pair<int, int>> idx;\n        for (int i=0; i<N; i++)\n            idx.push_back({nums[i], i});\n        \n        RMinQ<pair<int, int>> mn;\n        mn.init(idx);\n        RMaxQ<pair<int, int>> mx;\n        mx.init(idx);\n\n        priority_queue<pair<int, pair<int, int>>> m;\n        for (int i=0; i<N; i++) {\n            auto min_ = mn.query(0, i);\n            auto max_ = mx.query(0, i);\n            m.push({max_.first - min_.first, {0, i}});\n        }\n\n        int ans = 0;\n        while (k--) {\n            auto x = m.top();\n            m.pop();\n\n            ans += x.first;\n            if (x.second.first + 1 > x.second.second) \n                continue;\n            auto min_ = mn.query(x.second.first + 1, x.second.second);\n            auto max_ = mx.query(x.second.first + 1, x.second.second);\n            m.push({max_.first - min_.first, {x.second.first + 1, x.second.second}});\n        }\n        return ans;\n    }\n};\n","compare_result":"111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","title_slug":"maximum-total-subarray-value-ii","has_notes":false,"flag_type":1,"frontend_id":1236}