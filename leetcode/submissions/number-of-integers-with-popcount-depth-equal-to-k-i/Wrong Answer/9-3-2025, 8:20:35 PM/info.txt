{"id":1758872732,"question_id":3937,"lang":"cpp","lang_name":"C++","time":"2 months, 2 weeks","timestamp":1756956035,"status":11,"status_display":"Wrong Answer","runtime":"N/A","url":"/submissions/detail/1758872732/","is_pending":"Not Pending","title":"Number of Integers With Popcount-Depth Equal to K I","memory":"N/A","code":"class Solution {\npublic:\n    uint64_t greatest_lt_with_Pbits(uint64_t N, int P) {\n        if (P < 0 || P > 64) return -LLONG_MAX; \n        if (N == 0) return -LLONG_MAX; \n        int Q = __builtin_popcountll(N);\n    \n        if (P < Q) {\n            uint64_t x = N;\n            for (int t = 0; t < Q - P; ++t) x &= (x - 1);\n            return x;\n        }\n    \n        for (uint64_t scan = N; scan; scan &= (scan - 1)) {\n            int idx = __builtin_ctzll(scan);\n            uint64_t prefix;\n            if (idx == 63) prefix = 0; \n            else           prefix = (N >> (idx + 1)) << (idx + 1);\n    \n            int ones_above = __builtin_popcountll(prefix);\n            int need = P - ones_above; \n            if (0 <= need && need <= idx) {\n                uint64_t lower = (need == 0) ? 0ULL : (((1ULL << need) - 1) << (idx - need));\n                return prefix | lower;\n            }\n        }\n    \n        return -LLONG_MAX; \n    }\n\n    uint64_t nCk_u64(uint32_t n, uint32_t k) {\n        if (k > n) return 0;\n        k = std::min(k, n - k);\n        __int128 r = 1;                    \n        for (uint32_t i = 1; i <= k; ++i)  \n            r = (r * (n - i + 1)) / i;\n        return (uint64_t)r;               \n    }\n\n    long long calc(long long val) {\n        long long bits = __builtin_popcount(val);\n        long long sum = 0;\n        for (long long i=54; i>=1; i--) {\n            if ((1LL << i) & val) {\n                sum += nCk_u64(i, bits);\n                bits--;\n            }\n        }\n        return sum;\n    }\n\n    long long popcountDepth(long long n, int k) {\n        vector<int> cand;\n        for (int i=1; i<=53; i++) {\n            int val = i, sum = 0;\n            while (val != 1) {\n                val = __builtin_popcount(val);\n                sum++;\n            }\n            if (sum == k - 1)\n                cand.push_back(i);\n        }\n\n        long long sum = 0;\n        for (auto i : cand)\n            sum += greatest_lt_with_Pbits(n, i);\n        return sum;\n    }\n};","compare_result":"100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","title_slug":"number-of-integers-with-popcount-depth-equal-to-k-i","has_notes":false,"flag_type":1,"frontend_id":1185}