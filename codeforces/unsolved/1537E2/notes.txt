USE Z FUNCTION TO SPEED UP
